<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Visualizing Microbiome Taxonomy with Metacoder in R: A Step-by-Step Guide | Xin (David) Zhao </title> <meta name="author" content="Xin (David) Zhao"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.4/dist/bootstrap-table.min.css" integrity="sha256-uRX+PiRTR4ysKFRCykT8HLuRCub26LgXJZym3Yeom1c=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://davidzhao1015.github.io/blog/2025/tax-heattree-r/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Xin</span> (David) Zhao </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Visualizing Microbiome Taxonomy with Metacoder in R: A Step-by-Step Guide</h1> <p class="post-meta"> Created in August 23, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/taxonomy"> <i class="fa-solid fa-hashtag fa-sm"></i> taxonomy,</a>   <a href="/blog/tag/microbiome"> <i class="fa-solid fa-hashtag fa-sm"></i> microbiome,</a>   <a href="/blog/tag/visualization"> <i class="fa-solid fa-hashtag fa-sm"></i> visualization</a>   ·   <a href="/blog/category/bioinformatics"> <i class="fa-solid fa-tag fa-sm"></i> bioinformatics</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="introduction">Introduction</h2> <p>In microbiome research, stacked bar charts are a go-to method for showing the abundance of different taxa. But there’s a catch — they don’t really show the hierarchical relationships within the taxonomy data.</p> <p>That’s where the metacoder R package comes in. Published in <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC5340466/" rel="external nofollow noopener" target="_blank">PLoS ONE in 2017</a> and available on CRAN, metacoder makes it easier to explore and visualize taxonomy in a way that reflects its natural hierarchy, while also mapping data across different taxonomic levels.</p> <p>In this post, I’ll show you how to turn your own data into clean, publication-ready plots using metacoder. The package includes helpful <a href="https://grunwaldlab.github.io/metacoder_documentation/example.html" rel="external nofollow noopener" target="_blank">tutorials</a>, but they don’t always cover every scenario — like the one I’ll walk you through here.</p> <p>I’ll also share tips and lessons learned from my experience as an intermediate R user and microbiome researcher, so you can save time and avoid common pitfalls.<br><br></p> <h2 id="example">Example</h2> <p>For this example, I used a dataset curated from the <a href="https://pubmed.ncbi.nlm.nih.gov/35412130/" rel="external nofollow noopener" target="_blank">review</a> by Dr. Micheal Gaenzle on key microbiomes in food fermentation. The input data includes the full taxonomy lineages for more than 30 genera commonly involved in food fermentation.</p> <p>One particularly interesting table in the review maps these 30+ bacterial genera to 115 types of fermented foods from around the world. That inspired me to create a family-focused heat tree to visualize the biodiversity of bacteria involved in fermentation.</p> <p>Gathering detailed metadata for a perfectly accurate tree takes time, so for now, I worked with aggregated data — specifically, the proportion of fermented food types linked to each genus. While metacoder can integrate numeric data into heat trees, I found that it generated a misleading legend in this case. To keep the visualization clear, I’ve chosen not to display numeric values on the plot. Instead, I’ll describe the distribution of key bacterial families in the text alongside the visualization.</p> <p>The example input data can be download <a href="https://github.com/davidzhao1015/taxonomy-lineage-viz/blob/main/tax_abund_data.csv" rel="external nofollow noopener" target="_blank">here</a>.</p> <p>With that context set, let’s walk through the steps to prepare the data and generate the heat tree in R, so you can try it with your own dataset.<br><br></p> <h2 id="programmatic-workflow">Programmatic workflow</h2> <p>The overall workflow for this example is straightforward and involves three main steps:</p> <ol> <li>Read the taxonomy input data</li> <li>Parse the data into a taxmap object that is compatible with metacoder</li> <li>Generate and customize the heat tree visualization</li> </ol> <p>In the next sections, I’ll walk through each step, showing the code and explaining how you can adapt it to your own dataset.<br><br></p> <h2 id="implementation-in-r">Implementation in R</h2> <p><strong>1. Load and inspect your taxonomy data</strong></p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Load required library</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">metacoder</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">

</span><span class="c1"># Read in the taxonomy input file</span><span class="w">
</span><span class="n">tax_abund</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="s2">"tax_abund_data.csv"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; head(tax_abund)
  Species_label Fermented.foods1 normalized_prop        Kingdom         Phylum
1         spp_1               16       0.1391304 Pseudomonadati Pseudomonadota
2        spp_10              101       0.8782609      Bacillati      Bacillota
3        spp_11              101       0.8782609      Bacillati      Bacillota
4        spp_12              101       0.8782609      Bacillati      Bacillota
5        spp_13              101       0.8782609      Bacillati      Bacillota
6        spp_14              101       0.8782609      Bacillati      Bacillota
                Class           Order           Family                   Genus
1 Alphaproteobacteria Acetobacterales Acetobacteraceae             Acetobacter
2             Bacilli Lactobacillales Lactobacillaceae    Companilactobacillus
3             Bacilli Lactobacillales Lactobacillaceae Schleiferilactobacillus
4             Bacilli Lactobacillales Lactobacillaceae       Ligilactobacillus
5             Bacilli Lactobacillales Lactobacillaceae     Lactiplantibacillus
6             Bacilli Lactobacillales Lactobacillaceae      Loigolactobacillus
  Species
1      NA
2      NA
3      NA
4      NA
5      NA
6      NA
</code></pre></div></div> <p>This file contains the full taxonomy lineages for approximately 30 genera mentioned in Dr. Gaenzle’s review.</p> <ul> <li> <strong>Rows</strong>: Each row represents one genus.</li> <li> <strong>Columns</strong>: Include the full taxonomy path (Kingdom → Phylum → Class → Order → Family → Genus), along with aggregated counts and proportions of food types containing that genus.</li> <li> <strong>Species column</strong>: Values are set to NA where species-level data is not available.<br><br> </li> </ul> <p><strong>2. Parse the data into a <code class="language-plaintext highlighter-rouge">taxmap</code> object</strong></p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">obj</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">parse_tax_data</span><span class="p">(</span><span class="n">tax_abund</span><span class="p">,</span><span class="w"> </span><span class="n">class_cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="n">named_by_rank</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; print(obj)
&lt;Taxmap&gt;
  66 taxa: ab. Pseudomonadati, ac. Bacillati ... co. Lactobacillus
  66 edges: NA-&gt;ab, NA-&gt;ac, ab-&gt;ad ... bd-&gt;cm, be-&gt;cn, at-&gt;co
  2 data sets:
    tax_data:
      # A tibble: 36 × 11
        taxon_id Species_label Fermented.foods1 normalized_prop
        &lt;chr&gt;    &lt;chr&gt;                    &lt;int&gt;           &lt;dbl&gt;
      1 bf       spp_1                       16           0.139
      2 bg       spp_10                     101           0.878
      3 bh       spp_11                     101           0.878
      # ℹ 33 more rows
      # ℹ 7 more variables: Kingdom &lt;chr&gt;, Phylum &lt;chr&gt;, Class &lt;chr&gt;,
      #   Order &lt;chr&gt;, Family &lt;chr&gt;, Genus &lt;chr&gt;, Species &lt;lgl&gt;
      # ℹ Use `print(n = ...)` to see more rows
    tax_abund:
      # A tibble: 66 × 2
        taxon_id normalized_prop
        &lt;chr&gt;              &lt;dbl&gt;
      1 ab                 0.835
      2 ac                20.7  
      3 ad                 0.835
      # ℹ 63 more rows
      # ℹ Use `print(n = ...)` to see more rows
  0 functions:
</code></pre></div></div> <p><code class="language-plaintext highlighter-rouge">parse_tax_data()</code> transforms your table into a taxmap object that powers the heat tree visualization.</p> <ul> <li>The <code class="language-plaintext highlighter-rouge">class_cols</code> argument points to the column that contains the taxonomy path.</li> <li>Setting <code class="language-plaintext highlighter-rouge">named_by_rank</code> = TRUE ensures the function recognizes each taxonomic rank correctly.</li> </ul> <p><strong>3. Generate the heat tree</strong></p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">

</span><span class="n">ht_plot_abund</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">heat_tree</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w">
    </span><span class="n">node_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="o">$</span><span class="n">taxon_names</span><span class="p">(),</span><span class="w">
    </span><span class="n">node_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="o">$</span><span class="n">n_obs</span><span class="p">(),</span><span class="w">
    </span><span class="n">node_color_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"purple"</span><span class="p">,</span><span class="w"> </span><span class="s2">"yellow"</span><span class="p">,</span><span class="w"> </span><span class="s2">"red"</span><span class="p">),</span><span class="w">
    </span><span class="n">initial_layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"reingold-tilford"</span><span class="p">,</span><span class="w">
    </span><span class="n">layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"davidson-harel"</span><span class="p">,</span><span class="w">
    </span><span class="n">node_color_axis_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of genera \nwithin the taxa"</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">ht_plot_abund</span><span class="w">
</span></code></pre></div></div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/heat_tree_plot.png" sizes="95vw"></source> <img src="/assets/img/heat_tree_plot.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>This initial plot focuses on showing the hierarchical relationships.</p> <ul> <li>Because the numeric proportions generated a misleading legend, no quantitative data are mapped here.</li> <li>This keeps the visualization clean while still clearly showing the relationships between families and genera involved in fermentation.<br><br> </li> </ul> <h2 id="bonus">Bonus</h2> <h3 id="optional-add-quantitative-data-with-caution">Optional: Add quantitative data (with caution)</h3> <p>After you’ve parsed your taxonomy into a taxmap object, you can compute per-taxon values (e.g., the proportion of fermented food types per genus) and attach them to the object for plotting.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Calculate per-taxon abundance (here using a column called "normalized_prop")</span><span class="w">
</span><span class="c1"># This creates obj$data$tax_abund with one value per taxon</span><span class="w">
</span><span class="n">obj</span><span class="o">$</span><span class="n">data</span><span class="o">$</span><span class="n">tax_abund</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">calc_taxon_abund</span><span class="p">(</span><span class="w">
	</span><span class="n">obj</span><span class="p">,</span><span class="w"> 
	</span><span class="s2">"tax_data"</span><span class="p">,</span><span class="w"> 
	</span><span class="n">cols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"normalized_prop"</span><span class="p">)</span><span class="w">

</span><span class="c1"># Draw a heat tree using the computed values</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">

</span><span class="n">ht_plot_abund2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">heat_tree</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w">
    </span><span class="n">node_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="o">$</span><span class="n">taxon_names</span><span class="p">(),</span><span class="w"> </span><span class="c1"># Show taxon names</span><span class="w">
    </span><span class="n">node_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="o">$</span><span class="n">data</span><span class="o">$</span><span class="n">tax_abund</span><span class="o">$</span><span class="n">normalized_prop</span><span class="p">,</span><span class="w"> </span><span class="c1"># Size by proportions</span><span class="w">
    </span><span class="n">node_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obj</span><span class="o">$</span><span class="n">data</span><span class="o">$</span><span class="n">tax_abund</span><span class="o">$</span><span class="n">normalized_prop</span><span class="p">,</span><span class="w"> </span><span class="c1"># Color by proportions</span><span class="w">
    </span><span class="n">node_color_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"purple"</span><span class="p">,</span><span class="w"> </span><span class="s2">"yellow"</span><span class="p">,</span><span class="w"> </span><span class="s2">"red"</span><span class="p">),</span><span class="w"> </span><span class="c1"># Color palette</span><span class="w">
    </span><span class="n">initial_layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"reingold-tilford"</span><span class="p">,</span><span class="w">
    </span><span class="n">layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"davidson-harel"</span><span class="p">,</span><span class="w">
    </span><span class="n">node_color_axis_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Prop in Fermented Foods"</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">ht_plot_abund2</span><span class="w">
</span></code></pre></div></div> <p><strong>Why the caution?</strong></p> <p>Mapping numbers to node color/size can be powerful, but the legend and scaling can be misleading if your values are tightly clustered, all zeros, or contain many missing values. In my case, the legend confused readers, so I left numeric mappings out of the final figure and explained key patterns in the text instead.</p> <h3 id="optional-focus-at-the-family-level">Optional: Focus at the family level</h3> <p>You can subset the taxonomy to simplify the figure or highlight a specific level (e.g., <strong>family</strong>) and then plot. This often reveals clearer biological patterns.</p> <div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Keep families (and their super/subtaxa as you prefer) and color by count of child taxa</span><span class="w">
</span><span class="c1"># The example below hides genus nodes to emphasize family-level structure.</span><span class="w">

</span><span class="n">ht_plot_abund3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
    </span><span class="n">filter_taxa</span><span class="p">(</span><span class="n">taxon_ranks</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">"Genus"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="c1"># Drop genus nodes for a cleaner family-level view</span><span class="w">
    </span><span class="n">heat_tree</span><span class="p">(</span><span class="n">node_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taxon_names</span><span class="p">,</span><span class="w"> 
    </span><span class="n">node_color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n_obs</span><span class="p">,</span><span class="w">
    </span><span class="n">node_color_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"purple"</span><span class="p">,</span><span class="w"> </span><span class="s2">"yellow"</span><span class="p">,</span><span class="w"> </span><span class="s2">"red"</span><span class="p">),</span><span class="w">
    </span><span class="n">initial_layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"reingold-tilford"</span><span class="p">,</span><span class="w">
    </span><span class="n">layout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"davidson-harel"</span><span class="p">,</span><span class="w">
    </span><span class="n">node_color_axis_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of \ngenera within"</span><span class="p">)</span><span class="w">

</span><span class="n">ht_plot_abund3</span><span class="w">
</span></code></pre></div></div> <p><br></p> <h2 id="data-interpretation">Data Interpretation</h2> <p>The heat tree highlights several key insights about the diversity of bacteria involved in food fermentation:</p> <ul> <li>Core Fermenters – Families like <em>Lactobacillaceae</em>, <em>Leuconostocaceae</em>, <em>Streptococcaceae</em>, <em>Enterococcaceae</em>, and <em>Carnobacteriaceae</em> form the backbone of dairy, cereal, and vegetable fermentations.</li> <li>Initiators – <em>Enterobacteriaceae</em> and <em>Erwiniaceae</em> often kick-start spontaneous fermentations in vegetables, cereals, tubers, coffee, and cocoa.</li> <li>Niche Specialists – <em>Acetobacteraceae</em>, <em>Bacillaceae</em>, and <em>Propionibacteriaceae</em> are critical in vinegar, natto, soy/ fish sauces, and Swiss cheese fermentations.</li> <li>Surface &amp; Meat Fermenters – Families like <em>Staphylococcaceae</em>, <em>Micrococcaceae</em>, and <em>Brevibacteriaceae</em> play key roles in ripening, aroma development, and safety in meat and cheese fermentations.</li> <li>Minor but Emerging Players – <em>Eggerthellaceae</em> show a secondary but notable presence in vegetable fermentations such as sauerkraut and kimchi.</li> </ul> <p>These insights not only showcase the rich biodiversity of fermenting microbes but also highlight their specialized roles in shaping flavors, textures, and safety across different foods. For researchers, educators, or fermentation enthusiasts, such visualizations can guide strain selection, recipe development, and deeper exploration into the microbial ecosystems that make our favorite fermented products possible.<br><br></p> <h2 id="personal-tips">Personal tips</h2> <p>Here are a few tips from my experience working with metacoder.</p> <p><strong>Start with the examples</strong>: The package tutorials and help docs include plenty of sample datasets. Taking time to explore these will make it much easier to prepare your own input data correctly.</p> <p><strong>Legend adjustments are limited</strong>: While metacoder offers a lot of flexibility in customizing your plots, the position of the legend doesn’t seem to be adjustable. Plan your layout with that limitation in mind.</p> <p><strong>Interpret node sizes and colors carefully</strong>: These elements are proportional to your quantitative data, such as OTU counts or other biological variables. Always double-check your legend to avoid over- or under-interpreting the results.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Xin (David) Zhao. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.4/dist/bootstrap-table.min.js" integrity="sha256-4rppopQE9POKfukn2kEvhJ9Um25Cf6+IDVkARD0xh78=" crossorigin="anonymous"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"projects",description:"A growing collection of cool projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-cv",title:"cv",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"dropdown-publications",title:"publications",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-projects",title:"projects",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-blog",title:"blog",description:"",section:"Dropdown",handler:()=>{window.location.href="/blog/"}},{id:"post-visualizing-microbiome-taxonomy-with-metacoder-in-r-a-step-by-step-guide",title:"Visualizing Microbiome Taxonomy with Metacoder in R: A Step-by-Step Guide",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/tax-heattree-r/"}},{id:"post-how-to-retrieve-full-taxonomy-lineage-based-on-a-certain-rank-from-ncbi-taxonomy-database-using-python-api",title:"How to Retrieve full taxonomy lineage based on a certain rank from NCBI...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/retrieve-tax-lineage-API/"}},{id:"post-how-to-reconstruct-disease-onset-age-distributions-using-summary-statistics-a-rare-disease-use-case-in-python",title:"How to Reconstruct Disease Onset Age Distributions Using Summary Statistics: A Rare Disease...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/reconstruct-age-distribution/"}},{id:"post-a-beginner-s-hands-on-guide-to-meta-analysis-and-confidence-intervals",title:"A Beginner\u2019s Hands-On Guide to Meta-Analysis and Confidence Intervals",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/meta-analysis-in-R/"}},{id:"post-evaluating-confidence-interval-methods-under-skewness-practical-insights-from-simulation",title:"Evaluating Confidence Interval Methods under Skewness: Practical Insights from Simulation",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/mean-interval-estimators/"}},{id:"post-comparing-methods-for-estimating-95-confidence-intervals-of-proportions-wald-wilson-and-equal-tailed-jeffreys-prior",title:"Comparing Methods for Estimating 95% Confidence Intervals of Proportions: Wald, Wilson, and Equal-Tailed...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/benchmark-interval-prop/"}},{id:"post-modeling-diagnostic-delays-in-rare-disease-a-survival-analysis-case-study-in-python",title:"Modeling Diagnostic Delays in Rare Disease: A Survival Analysis Case Study in Python...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/delay-diganosis-survival-analysis/"}},{id:"post-from-microbiology-to-bioinformatics-how-embracing-new-skills-transformed-my-career",title:"From Microbiology to Bioinformatics: How Embracing New Skills Transformed My Career",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/my-career-journey/"}},{id:"post-beyond-heatmaps-mapping-two-variables-with-plotly-in-public-health",title:"Beyond Heatmaps: Mapping Two Variables with Plotly in Public Health",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/plotly-maps-public-health/"}},{id:"post-how-to-import-excel-files-in-python",title:"How to Import Excel Files in Python",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/import-spreadsheet-python/"}},{id:"post-top-r-packages-for-go-enrichment-analysis-topgo-vs-globaltest-explained",title:"Top R Packages for GO Enrichment Analysis: topGO vs globaltest Explained",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/go-enrichment/"}},{id:"post-how-to-run-r-code-in-jupyter-notebook-within-vs-code-a-step-by-step-guide",title:"How to Run R Code in Jupyter Notebook within VS Code: A Step-by-Step...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/R-kernel-jupyter/"}},{id:"post-how-to-perform-power-analysis-for-high-throughput-omics-data-using-sspa-a-guide-to-the-bioconductor-package",title:"How to Perform Power Analysis for High-Throughput Omics Data Using SSPA, A Guide...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/power-analysis/"}},{id:"post-automating-reporting-with-rmarkdown",title:"Automating Reporting with RMarkdown",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/auto-reporting-rmarkdown/"}},{id:"post-introduction-to-linear-mixed-models-with-the-limma-package",title:"Introduction to Linear Mixed Models with the limma Package",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/linear-mixed-model/"}},{id:"post-choosing-the-right-dimensionality-reduction-in-metabolomics-navigating-common-pitfalls",title:"Choosing the Right Dimensionality Reduction in Metabolomics: Navigating Common Pitfalls",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/choose-dimension-reduction/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"projects-gc-autofit-web-application-automating-and-accelerating-gc-ms-metabolomics",title:"GC-AutoFit: Web Application Automating and Accelerating GC-MS Metabolomics",description:"",section:"Projects",handler:()=>{window.location.href="/projects/gc-autofit/"}},{id:"projects-exploring-ames-housing-prices-a-data-driven-analysis",title:"Exploring Ames Housing Prices: A Data-Driven Analysis",description:"Exploratory data analysis for house price prediction, a Kaggle competition",section:"Projects",handler:()=>{window.location.href="/projects/house-price-prediction/"}},{id:"projects-impact-of-birth-factors-on-infant-gut-health-insights-from-a-microbiota-study",title:"Impact of Birth Factors on Infant Gut Health, Insights from a Microbiota Study...",description:"",section:"Projects",handler:()=>{window.location.href="/projects/infant_bifido_birth/"}},{id:"projects-predict-childhood-obesity-using-rf-xgboost-and-glmm-in-r",title:"Predict Childhood Obesity Using RF, XGBoost and GLMM in R",description:"",section:"Projects",handler:()=>{window.location.href="/projects/predict_obesity_machine_learning/"}},{id:"projects-vitamin-d-and-infant-gut-health-a-regression-analysis",title:"Vitamin D and Infant Gut Health, A Regression Analysis",description:"",section:"Projects",handler:()=>{window.location.href="/projects/vitD_infant_gut/"}},{id:"projects-wegan-web-application-streamlining-ecology-data-analysis",title:"WEGAN: Web Application Streamlining Ecology Data Analysis",description:"",section:"Projects",handler:()=>{window.location.href="/projects/wegan_web_app/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%64%61%76%69%64%7A%68%61%6F%31%30%31%35@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=OVK0_oAAAAAJ&hl=en","_blank")}},{id:"socials-researchgate",title:"ResearchGate",section:"Socials",handler:()=>{window.open("https://www.researchgate.net/profile/Xin-Zhao-5/","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/davidzhao1015","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/davidxzhao","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>