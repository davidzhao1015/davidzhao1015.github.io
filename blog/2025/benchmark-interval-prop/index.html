<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Comparing Methods for Estimating 95% Confidence Intervals of Proportions: Wald, Wilson, and Equal-Tailed Jeffreys Prior | Xin (David) Zhao </title> <meta name="author" content="Xin (David) Zhao"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.4/dist/bootstrap-table.min.css" integrity="sha256-uRX+PiRTR4ysKFRCykT8HLuRCub26LgXJZym3Yeom1c=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://davidzhao1015.github.io/blog/2025/benchmark-interval-prop/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Xin</span> (David) Zhao </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Comparing Methods for Estimating 95% Confidence Intervals of Proportions: Wald, Wilson, and Equal-Tailed Jeffreys Prior</h1> <p class="post-meta"> Created in April 01, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/confidence-intervals"> <i class="fa-solid fa-hashtag fa-sm"></i> confidence-intervals,</a>   <a href="/blog/tag/statistics"> <i class="fa-solid fa-hashtag fa-sm"></i> statistics,</a>   <a href="/blog/tag/proportions"> <i class="fa-solid fa-hashtag fa-sm"></i> proportions,</a>   <a href="/blog/tag/methods-comparison"> <i class="fa-solid fa-hashtag fa-sm"></i> methods-comparison</a>   ·   <a href="/blog/category/statistics"> <i class="fa-solid fa-tag fa-sm"></i> statistics</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <blockquote> <p><strong>How much can you trust a number when dealing with rare events?</strong></p> <p>In statistics, it’s not just about getting an estimate — it’s about knowing how uncertain that estimate really is.</p> </blockquote> <h2 id="introduction"><strong>Introduction</strong></h2> <p>Estimating confidence intervals (CIs) for proportions is a fundamental task in statistical analysis, particularly in fields like epidemiology, public health, and rare disease research.</p> <p>Confidence intervals provide a measure of uncertainty around point estimates like incidence rates, prevalence, and response rates, helping researchers and decision-makers gauge the reliability of their findings.</p> <p>However, constructing accurate confidence intervals for proportions is not always straightforward—especially when dealing with small sample sizes or rare events, where traditional methods may fall short.</p> <p>In this post, we focus on three widely used methods for estimating 95% confidence intervals for proportions:</p> <ul> <li> <p><strong>Wald Method:</strong></p> <p>A traditional approach based on the normal approximation, known for its simplicity but prone to inaccuracies in small samples or when proportions are close to 0 or 1.</p> </li> <li> <p><strong>Wilson Method:</strong></p> <p>An improved frequentist method that adjusts for the shortcomings of Wald, offering more reliable intervals that stay within logical bounds.</p> </li> <li> <p><strong>Equal-Tailed Jeffreys Prior Method:</strong></p> <p>A Bayesian approach using a non-informative prior, known for its excellent frequentist properties and particularly strong performance in rare event settings.</p> </li> </ul> <p>Through simulations designed to mimic rare disease scenarios, we will benchmark these methods, providing both empirical insights and practical Python code to guide method selection in real-world analyses.</p> <h2 id="purpose-of-the-post">Purpose of the post</h2> <p>Which method gives the most reliable confidence interval for proportions? The short answer: it depends. As highlighted by the classic review by Brown et al., the performance of CI estimation methods can vary based on factors like sample size and how close the true proportion is to 0 or 1.</p> <p>This post puts three popular methods—Wald, Wilson, and the equal-tailed Jeffreys prior—to the test using simulated data. By benchmarking their performance, especially in rare disease contexts where small samples are common, we aim to provide practical guidance for choosing the right method—along with reusable Python code for each.</p> <hr> <h2 id="understanding-confidence-intervals-for-proportions"><strong>Understanding Confidence Intervals for Proportions</strong></h2> <p>In statistical analysis, a <strong>confidence interval (CI)</strong> provides a range of plausible values for an unknown population parameter based on observed data.</p> <p>When estimating a <strong>proportion</strong>—such as the incidence of a rare disease, the prevalence of a microbial species, or a treatment success rate—the confidence interval quantifies the uncertainty around the point estimate.</p> <p>Rather than relying solely on a single value (e.g., “2% prevalence”), a 95% confidence interval might tell us that the true prevalence is likely between 1.5% and 2.7%, offering a more complete picture of the estimate’s reliability.</p> <p>Mathematically, a 95% CI means that if we were to repeat the study many times under the same conditions, about 95% of the constructed intervals would contain the true proportion.</p> <hr> <h3 id="why-accurate-interval-estimation-matters"><strong>Why Accurate Interval Estimation Matters</strong></h3> <p>Accurate estimation of confidence intervals is critically important in fields like <strong>epidemiology</strong> and <strong>microbiome research</strong>, where:</p> <ul> <li> <p><strong>Rare Disease Studies:</strong></p> <p>Small sample sizes and extremely low event rates are common. Overly narrow or inaccurate intervals can falsely suggest high precision, leading to misguided conclusions about disease risk, treatment efficacy, or healthcare burden.</p> </li> <li> <p><strong>Microbiome Studies:</strong></p> <p>The presence or abundance of microbial taxa can be rare or highly variable. Reliable intervals help interpret findings with appropriate caution, avoiding overinterpretation of noisy or sparse data.</p> </li> </ul> <p>Poorly constructed intervals—especially those that underestimate uncertainty—can mislead both researchers and policymakers, leading to flawed decision-making, missed treatment opportunities, or inappropriate resource allocation.</p> <p>Thus, selecting a method that maintains valid coverage while offering reasonable precision is not merely a technical preference; it is essential for trustworthy science.</p> <hr> <h2 id="overview-of-the-methods"><strong>Overview of the Methods</strong></h2> <p>Building on insights from Brown et al., here’s a practical overview of the Wald, Wilson, and Jeffreys methods—covering key concepts, formulas, and typical use cases.</p> <h3 id="wald-method"><strong>Wald Method</strong></h3> <ul> <li> <p><strong>Formula:</strong></p> \[\hat{p} \pm z_{\alpha/2} \sqrt{\frac{\hat{p}(1 - \hat{p})}{n}}\] <p></p> </li> <li> <p><strong>Summary:</strong></p> <p>Simple and widely taught, but often inaccurate—especially with small samples or proportions near 0 or 1.</p> </li> <li> <p><strong>Limitations:</strong></p> <p>Poor coverage, unstable even with moderate to large samples; not recommended for rare event settings.</p> </li> </ul> <h3 id="wilson-method"><strong>Wilson Method</strong></h3> <ul> <li> <p><strong>Formula:</strong></p> \[\frac{\hat{p} + \frac{z^2}{2n} \pm z \sqrt{ \frac{\hat{p}(1 - \hat{p})}{n} + \frac{z^2}{4n^2} }}{1 + \frac{z^2}{n}}\] <p></p> </li> <li> <p><strong>Summary:</strong></p> <p>A corrected method that improves coverage and keeps intervals within [0,1].</p> </li> <li> <p><strong>Advantages:</strong></p> <p>Reliable even with small samples; recommended for real-world use over Wald.</p> </li> </ul> <h3 id="jeffreys-method"><strong>Jeffreys Method</strong></h3> <ul> <li> <p><strong>Formula:</strong></p> <p>Based on Beta posterior:</p> \[\text{Beta}(X+0.5, n-X+0.5)\] <p></p> </li> <li> <p><strong>Summary:</strong></p> <p>A Bayesian-based method with strong frequentist performance, especially for rare events.</p> </li> <li> <p><strong>Advantages:</strong></p> <p>Excellent coverage, stable near boundaries, highly suitable for small sample and rare event studies.</p> </li> </ul> <hr> <h2 id="estimating-confidence-intervals-a-hands-on-example"><strong>Estimating Confidence Intervals: A Hands-On Example</strong></h2> <p>Before diving into large-scale simulations, let’s first walk through a simple example to see how the three methods—Wald, Wilson, and Jeffreys—work in practice.</p> <p>We’ll assume:</p> <ul> <li> <strong>Sample size (n):</strong> 2000</li> <li> <strong>Number of cases (x):</strong> 1</li> </ul> <p>Using Python’s statsmodels package, we can easily calculate the 95% confidence intervals for the proportion estimate using each method.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">statsmodels.stats.proportion</span> <span class="kn">import</span> <span class="n">proportion_confint</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1"># Set the random seed for reproducibility
</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="c1"># Define parameters
</span><span class="n">cases</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2000</span>

<span class="c1"># 1. Wald method
</span><span class="n">ci_wald_estimate</span> <span class="o">=</span> <span class="nf">proportion_confint</span><span class="p">(</span><span class="n">cases</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">normal</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">95% Wald CI: [</span><span class="si">{</span><span class="n">ci_wald_estimate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">ci_wald_estimate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">]</span><span class="sh">'</span><span class="p">)</span> 

<span class="c1"># 2. Wilson method
</span><span class="n">ci_wilson_estimate</span> <span class="o">=</span> <span class="nf">proportion_confint</span><span class="p">(</span><span class="n">cases</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">wilson</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">95% Wilson CI: [</span><span class="si">{</span><span class="n">ci_wilson_estimate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">ci_wilson_estimate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">]</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 3. Jeffreys method
</span><span class="n">ci_jeffreys_estimate</span> <span class="o">=</span> <span class="nf">proportion_confint</span><span class="p">(</span><span class="n">cases</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">jeffreys</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">95% Jeffreys CI: [</span><span class="si">{</span><span class="n">ci_jeffreys_estimate</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">ci_jeffreys_estimate</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">]</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <h3 id="output">Output:</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mi">95</span><span class="o">%</span> <span class="n">Wald</span> <span class="n">CI</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.0015</span><span class="p">]</span>
<span class="mi">95</span><span class="o">%</span> <span class="n">Wilson</span> <span class="n">CI</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.0028</span><span class="p">]</span>
<span class="mi">95</span><span class="o">%</span> <span class="n">Jeffreys</span> <span class="n">CI</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0001</span><span class="p">,</span> <span class="mf">0.0023</span><span class="p">]</span>
</code></pre></div></div> <h3 id="key-observations">Key Observations</h3> <ul> <li> <strong>Wald method</strong> technically stays within the [0,1] range, but its lower bound rounds to zero, reflecting how poorly it behaves for very small proportions.</li> <li> <strong>Wilson method</strong> corrects for this issue and offers a wider, safer interval that remains fully positive.</li> <li> <strong>Jeffreys method</strong> also produces a valid and slightly narrower interval compared to Wilson, benefiting from Bayesian adjustments that naturally avoid the zero-boundary problem.</li> </ul> <p>This small example already shows a clear trend: for rare events (like in rare disease epidemiology), robust methods like Wilson and Jeffreys provide more reliable and interpretable intervals than the traditional Wald method.</p> <p>In the next section, we’ll benchmark these methods more systematically using simulated datasets across a range of sample sizes and true proportions.</p> <hr> <h2 id="comparing-the-methods"><strong>Comparing the Methods</strong></h2> <p>To systematically evaluate the performance of the Wald, Wilson, and Jeffreys methods, we conducted a benchmark analysis using simulated data designed to mimic real-world rare disease studies.</p> <p>We intentionally defined:</p> <ul> <li> <strong>Sample sizes</strong> ranging from 30 to 30,000, representing single-center cohorts up to large national registries.</li> <li> <strong>True event proportions</strong> ranging from 0.0005 to 0.02, reflecting the extremely low rates typical in rare diseases.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Define simulation parameters
</span><span class="n">sample_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">30000</span><span class="p">]</span>
<span class="n">true_proportion</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0005</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">]</span>
<span class="n">n_simulations</span> <span class="o">=</span> <span class="mi">1000</span>
</code></pre></div></div> <h3 id="performance-metrics"><strong>Performance Metrics</strong></h3> <p>We evaluated each method based on two key metrics:</p> <ul> <li> <strong>Coverage Probability:</strong> How often the 95% confidence interval contains the true proportion (i.e., accuracy).</li> <li> <strong>Average Confidence Interval Width:</strong> Reflecting the precision of the estimate (narrower is better, assuming coverage is adequate).</li> </ul> <p>This setup allows us to explore an important practical question:</p> <blockquote> <p>Which method strikes the best balance between accuracy and precision, especially under challenging rare disease conditions?</p> </blockquote> <hr> <h3 id="coverage-probability"><strong>Coverage Probability</strong></h3> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/barplot_coverage_facet_tall.png" sizes="95vw"></source> <img src="/assets/img/barplot_coverage_facet_tall.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>The figure above shows how the coverage probability varies across different sample sizes and true proportions for the three methods: Wald, Wilson, and Jeffreys. The dashed red line marks the target 95% coverage.</p> <h4 id="key-observations-1"><strong>Key Observations:</strong></h4> <ul> <li> <strong>Jeffreys Method:</strong> <ul> <li>Jeffreys consistently maintains or exceeds 95% coverage across all combinations of sample sizes and true proportions.</li> <li>Even in very small samples (e.g., n=30) and extremely low proportions (e.g., 0.0005), Jeffreys remains robust.</li> <li>This highlights its strength for rare event scenarios where maintaining coverage is critical.</li> </ul> </li> <li> <strong>Wilson Method:</strong> <ul> <li>Wilson performs comparably to Jeffreys in many scenarios, particularly as sample size increases.</li> <li>However, at very small sample sizes (e.g., n=30, 100) and very rare proportions (e.g., 0.0005–0.001), Wilson coverage sometimes drops slightly below 95%.</li> <li>It becomes increasingly reliable as sample size grows.</li> </ul> </li> <li> <strong>Wald Method:</strong> <ul> <li>Wald shows poor coverage in almost all small-to-moderate sample size settings, often falling far below the 95% target.</li> <li>At very low true proportions (e.g., 0.005 or lower), even increasing sample size to 1000 does not fully rescue the Wald method.</li> <li>Only with very large sample sizes (n=30,000) and higher true proportions (e.g., 0.02) does Wald approach acceptable coverage.</li> </ul> </li> </ul> <h4 id="additional-nuances"><strong>Additional Nuances:</strong></h4> <ul> <li> <strong>Effect of True Proportion:</strong> <ul> <li>Lower true proportions (e.g., 0.0005, 0.001) make it harder for methods to maintain ideal coverage, especially noticeable for Wald and, to a lesser extent, Wilson.</li> <li>As true proportion increases (e.g., 0.02), all methods tend to perform better, but differences still remain.</li> </ul> </li> <li> <strong>Effect of Sample Size:</strong> <ul> <li>Larger sample sizes systematically improve coverage for all methods, but Wald still lags behind unless the sample size is very large.</li> </ul> </li> </ul> <h4 id="practical-implications"><strong>Practical Implications:</strong></h4> <ul> <li> <strong>Jeffreys method</strong> is the most dependable choice for rare event settings where preserving nominal confidence levels is crucial.</li> <li> <strong>Wilson method</strong> is a strong practical alternative, especially in moderate-to-large sample settings, offering better behavior than Wald.</li> <li> <strong>Wald method</strong> should generally be avoided for rare disease applications unless working with extremely large cohorts and relatively higher event proportions.</li> </ul> <hr> <h3 id="average-confidence-interval-width"><strong>Average Confidence Interval Width</strong></h3> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/barplot_precision_facet.png" sizes="95vw"></source> <img src="/assets/img/barplot_precision_facet.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>95% CI width by methods controlling for the sample sizes and true proportions</p> <p>The figure above illustrates the average length of 95% confidence intervals across different sample sizes and true proportions, comparing the Wald, Wilson, and Jeffreys methods.</p> <h4 id="key-observations-2"><strong>Key Observations:</strong></h4> <ul> <li> <strong>Wald Method:</strong> <ul> <li>Wald consistently produces the narrowest confidence intervals across all settings.</li> <li>However, given Wald’s poor coverage performance (as seen in the previous figure), these narrower intervals are misleading — they falsely suggest higher precision while actually underestimating the true uncertainty.</li> <li>Thus, the apparent precision of Wald should be interpreted with caution: it’s a <em>false sense</em> of accuracy.</li> </ul> </li> <li> <strong>Wilson and Jeffreys Methods:</strong> <ul> <li>Wilson intervals are wider than Jeffreys across almost all settings, particularly noticeable when both sample size is small and true proportion is low.</li> <li>Jeffreys consistently achieves <strong>slightly narrower intervals</strong> than Wilson while still maintaining better or comparable coverage.</li> <li>This suggests Jeffreys method offers <strong>superior precision among the reliable methods</strong>.</li> </ul> </li> <li> <strong>Effect of Sample Size:</strong> <ul> <li>As sample size increases, the width of the confidence intervals shrinks for all methods, as expected.</li> <li>When sample size reaches 30,000, all methods yield very narrow intervals, and differences between methods become minimal.</li> </ul> </li> <li> <strong>Effect of True Proportion:</strong> <ul> <li>Larger true proportions (e.g., 0.02) generally lead to wider intervals compared to extremely low proportions (e.g., 0.0005), because variance is inherently higher when the probability is farther from 0 or 1.</li> </ul> </li> </ul> <hr> <h2 id="practical-considerations"><strong>Practical Considerations</strong></h2> <p>When selecting a method to construct confidence intervals for proportions—especially in rare disease contexts—it is crucial to match the method to the study’s characteristics. Below are key guidelines and common pitfalls to watch for:</p> <p><strong>Choosing the Appropriate Method</strong></p> <table> <thead> <tr> <th><strong>Scenario</strong></th> <th><strong>Recommended Method</strong></th> <th><strong>Reason</strong></th> </tr> </thead> <tbody> <tr> <td>Very small sample size (n ≤ 100) and rare events</td> <td>Jeffreys</td> <td>Best coverage; robust even with extreme rarity</td> </tr> <tr> <td>Moderate sample size (n ~ 300–1000), low prevalence</td> <td>Jeffreys or Wilson</td> <td>Both offer reliable coverage; Jeffreys slightly narrower intervals</td> </tr> <tr> <td>Large sample size (n ≥ 10,000), moderate proportions (e.g., 0.01–0.02)</td> <td>Wilson or Jeffreys</td> <td>Minor differences; both safe choices</td> </tr> <tr> <td>Extremely large sample size (n ≥ 30,000) with not-so-rare events</td> <td>Wilson (or even Wald)</td> <td>Wald acceptable only under these conditions</td> </tr> </tbody> </table> <h3 id="potential-pitfalls-and-how-to-avoid-them"><strong>Potential Pitfalls and How to Avoid Them</strong></h3> <ul> <li> <strong>Pitfall 1: Blindly Using the Wald Method</strong> <ul> <li> <strong>Issue:</strong> Wald intervals can be too narrow and may miss the true proportion, especially with small samples or low event rates.</li> <li> <strong>Solution:</strong> Prefer Wilson or Jeffreys methods for rare events or small sample studies.</li> </ul> </li> <li> <strong>Pitfall 2: Overemphasizing Narrow Intervals</strong> <ul> <li> <strong>Issue:</strong> A narrow interval is meaningless if coverage probability is poor (i.e., interval doesn’t capture the true proportion reliably).</li> <li> <strong>Solution:</strong> Prioritize methods with strong coverage (like Jeffreys and Wilson) before focusing on interval width.</li> </ul> </li> <li> <strong>Pitfall 3: Assuming “One Size Fits All”</strong> <ul> <li> <strong>Issue:</strong> The best method depends on both sample size and true event rate.</li> <li> <strong>Solution:</strong> Tailor your method choice based on study characteristics (refer to the table above).</li> </ul> </li> </ul> <hr> <h2 id="conclusion"><strong>Conclusion</strong></h2> <p>Choosing the right method to estimate confidence intervals for proportions is critical—especially when studying rare events in small cohorts, as is often the case in rare disease research.</p> <p>This analysis highlights that:</p> <ul> <li> <strong>Jeffreys method</strong> consistently delivers the best balance: reliable coverage and high precision across challenging scenarios.</li> <li> <strong>Wilson method</strong> remains a strong, practical alternative, particularly when ease of interpretation or computational simplicity is needed.</li> <li> <strong>Wald method</strong>, despite its simplicity, should be avoided unless working with extremely large samples and relatively high event rates.</li> </ul> <p>In rare disease studies where sample sizes are often small and events are extremely rare, robust methods like <strong>Jeffreys</strong> or <strong>Wilson</strong> are not just preferable—they are essential for trustworthy statistical inference.</p> <p>When precision matters, and lives or health policy decisions could depend on these estimates, <strong>choose your method thoughtfully</strong>.</p> <p>Good science begins with good measurement.</p> <hr> <h2 id="putting-it-into-practice"><strong>Putting It Into Practice</strong></h2> <p>To help you apply these methods in your own work, I’ve prepared clean, reusable Python code that:</p> <ul> <li>Calculates Wald, Wilson, and Jeffreys confidence intervals</li> <li>Benchmarks performance across different sample sizes and true proportions</li> <li>Summarizes key metrics like coverage probability and interval width</li> </ul> <p>You can easily adapt the code to:</p> <ul> <li>Analyze your own datasets</li> <li>Test other confidence levels (e.g., 90%, 99%)</li> <li>Extend the benchmarking to new methods</li> </ul> <p>Whether you’re working on rare disease epidemiology, microbiome studies, or any research involving proportions, these code snippets are ready to plug into your analysis.</p> <p>Access the full code <a href="https://github.com/davidzhao1015/interval-estimate-benchmark/blob/main/compare-interval-est-methods.py" rel="external nofollow noopener" target="_blank">here</a>.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Xin (David) Zhao. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.4/dist/bootstrap-table.min.js" integrity="sha256-4rppopQE9POKfukn2kEvhJ9Um25Cf6+IDVkARD0xh78=" crossorigin="anonymous"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"projects",description:"A growing collection of cool projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-cv",title:"cv",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"dropdown-publications",title:"publications",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-projects",title:"projects",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-blog",title:"blog",description:"",section:"Dropdown",handler:()=>{window.location.href="/blog/"}},{id:"post-turning-messy-symptom-text-into-structured-insights",title:"Turning Messy Symptom Text into Structured Insights",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/map-hpo-symptom/"}},{id:"post-visualizing-microbiome-taxonomy-with-metacoder-in-r-a-step-by-step-guide",title:"Visualizing Microbiome Taxonomy with Metacoder in R: A Step-by-Step Guide",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/tax-heattree-r/"}},{id:"post-retrieving-full-taxonomy-lineage-from-ncbi-with-python",title:"Retrieving Full Taxonomy Lineage from NCBI with Python",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/retrieve-tax-lineage-API/"}},{id:"post-how-to-reconstruct-disease-onset-age-distributions-using-summary-statistics-a-rare-disease-use-case-in-python",title:"How to Reconstruct Disease Onset Age Distributions Using Summary Statistics: A Rare Disease...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/reconstruct-age-distribution/"}},{id:"post-a-beginner-s-hands-on-guide-to-meta-analysis-and-confidence-intervals",title:"A Beginner\u2019s Hands-On Guide to Meta-Analysis and Confidence Intervals",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/meta-analysis-in-R/"}},{id:"post-evaluating-confidence-interval-methods-under-skewness-practical-insights-from-simulation",title:"Evaluating Confidence Interval Methods under Skewness: Practical Insights from Simulation",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/mean-interval-estimators/"}},{id:"post-comparing-methods-for-estimating-95-confidence-intervals-of-proportions-wald-wilson-and-equal-tailed-jeffreys-prior",title:"Comparing Methods for Estimating 95% Confidence Intervals of Proportions: Wald, Wilson, and Equal-Tailed...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/benchmark-interval-prop/"}},{id:"post-modeling-diagnostic-delays-in-rare-disease-a-survival-analysis-case-study-in-python",title:"Modeling Diagnostic Delays in Rare Disease: A Survival Analysis Case Study in Python...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/delay-diganosis-survival-analysis/"}},{id:"post-from-microbiology-to-bioinformatics-how-embracing-new-skills-transformed-my-career",title:"From Microbiology to Bioinformatics: How Embracing New Skills Transformed My Career",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/my-career-journey/"}},{id:"post-beyond-heatmaps-mapping-two-variables-with-plotly-in-public-health",title:"Beyond Heatmaps: Mapping Two Variables with Plotly in Public Health",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/plotly-maps-public-health/"}},{id:"post-how-to-import-excel-files-in-python",title:"How to Import Excel Files in Python",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/import-spreadsheet-python/"}},{id:"post-top-r-packages-for-go-enrichment-analysis-topgo-vs-globaltest-explained",title:"Top R Packages for GO Enrichment Analysis: topGO vs globaltest Explained",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/go-enrichment/"}},{id:"post-how-to-run-r-code-in-jupyter-notebook-within-vs-code-a-step-by-step-guide",title:"How to Run R Code in Jupyter Notebook within VS Code: A Step-by-Step...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/R-kernel-jupyter/"}},{id:"post-how-to-perform-power-analysis-for-high-throughput-omics-data-using-sspa-a-guide-to-the-bioconductor-package",title:"How to Perform Power Analysis for High-Throughput Omics Data Using SSPA, A Guide...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/power-analysis/"}},{id:"post-automating-reporting-with-rmarkdown",title:"Automating Reporting with RMarkdown",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/auto-reporting-rmarkdown/"}},{id:"post-introduction-to-linear-mixed-models-with-the-limma-package",title:"Introduction to Linear Mixed Models with the limma Package",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/linear-mixed-model/"}},{id:"post-choosing-the-right-dimensionality-reduction-in-metabolomics-navigating-common-pitfalls",title:"Choosing the Right Dimensionality Reduction in Metabolomics: Navigating Common Pitfalls",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/choose-dimension-reduction/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"projects-gc-autofit-web-application-automating-and-accelerating-gc-ms-metabolomics",title:"GC-AutoFit: Web Application Automating and Accelerating GC-MS Metabolomics",description:"",section:"Projects",handler:()=>{window.location.href="/projects/gc-autofit/"}},{id:"projects-exploring-ames-housing-prices-a-data-driven-analysis",title:"Exploring Ames Housing Prices: A Data-Driven Analysis",description:"Exploratory data analysis for house price prediction, a Kaggle competition",section:"Projects",handler:()=>{window.location.href="/projects/house-price-prediction/"}},{id:"projects-impact-of-birth-factors-on-infant-gut-health-insights-from-a-microbiota-study",title:"Impact of Birth Factors on Infant Gut Health, Insights from a Microbiota Study...",description:"",section:"Projects",handler:()=>{window.location.href="/projects/infant_bifido_birth/"}},{id:"projects-predict-childhood-obesity-using-rf-xgboost-and-glmm-in-r",title:"Predict Childhood Obesity Using RF, XGBoost and GLMM in R",description:"",section:"Projects",handler:()=>{window.location.href="/projects/predict_obesity_machine_learning/"}},{id:"projects-vitamin-d-and-infant-gut-health-a-regression-analysis",title:"Vitamin D and Infant Gut Health, A Regression Analysis",description:"",section:"Projects",handler:()=>{window.location.href="/projects/vitD_infant_gut/"}},{id:"projects-wegan-web-application-streamlining-ecology-data-analysis",title:"WEGAN: Web Application Streamlining Ecology Data Analysis",description:"",section:"Projects",handler:()=>{window.location.href="/projects/wegan_web_app/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%64%61%76%69%64%7A%68%61%6F%31%30%31%35@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=OVK0_oAAAAAJ&hl=en","_blank")}},{id:"socials-researchgate",title:"ResearchGate",section:"Socials",handler:()=>{window.open("https://www.researchgate.net/profile/Xin-Zhao-5/","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/davidzhao1015","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/davidxzhao","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>