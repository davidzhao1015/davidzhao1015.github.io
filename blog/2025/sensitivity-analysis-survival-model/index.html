<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Parametric Survival Fit &amp; PSA for Age-at-Onset in Autoimmune Disease: Generalized Gamma Workflow | Xin (David) Zhao </title> <meta name="author" content="Xin (David) Zhao"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.4/dist/bootstrap-table.min.css" integrity="sha256-uRX+PiRTR4ysKFRCykT8HLuRCub26LgXJZym3Yeom1c=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://davidzhao1015.github.io/blog/2025/sensitivity-analysis-survival-model/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Xin</span> (David) Zhao </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/projects/">projects</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">Parametric Survival Fit &amp; PSA for Age-at-Onset in Autoimmune Disease: Generalized Gamma Workflow</h1> <p class="post-meta"> Created in November 15, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/tag/sensitivity-analysis"> <i class="fa-solid fa-hashtag fa-sm"></i> sensitivity-analysis,</a>   <a href="/blog/tag/survival-model"> <i class="fa-solid fa-hashtag fa-sm"></i> survival-model,</a>   <a href="/blog/tag/epi"> <i class="fa-solid fa-hashtag fa-sm"></i> epi,</a>   <a href="/blog/tag/health-economy"> <i class="fa-solid fa-hashtag fa-sm"></i> health-economy</a>   ·   <a href="/blog/category/bioinformatics"> <i class="fa-solid fa-tag fa-sm"></i> bioinformatics</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>In rare disease epidemiology, researchers often face a familiar challenge: most published studies do not provide individual-level patient data. Instead, they report only high-level summary statistics such as quartiles, means, and total sample size. Yet for health economic modeling, burden of disease estimation, or natural history modeling, we still need to understand the full age-at-onset distribution, including its shape, skew, and uncertainty.</p> <p>This article presents a practical workflow for reconstructing that distribution using parametric survival models, with a focus on the generalized gamma distribution. We will also show how to incorporate parameter uncertainty using probabilistic sensitivity analysis (PSA) and how to compute key outputs such as diagnosis probabilities within specific age bands.</p> <p>This workflow is adapted from a full analysis <a href="sen-analysis-Gamma-MVN-Cholesky.ipynb">notebook</a>, and is intended to be immediately useful for epidemiologists, biostatisticians, and health economists working with sparse or aggregate-only datasets.<br><br></p> <h2 id="1-why-parametric-survival-modeling-matters">1. Why Parametric Survival Modeling Matters</h2> <p>When individual-level data are unavailable, modeling decisions become difficult:</p> <ul> <li>How do we estimate onset age distributions when we only know quartiles?</li> <li>How can downstream models quantify uncertainty?</li> <li>Can we still estimate age-specific probabilities, like onset before 12 or after 18?</li> </ul> <p>The answer is <em>yes</em>. Well-chosen parametric models—fit using a quantile-matching method—allow us to approximate the underlying distribution closely enough for epidemiological and health economic purposes.</p> <p>The approach also supports probabilistic uncertainty methods widely used in cost-effectiveness modeling.<br><br></p> <h2 id="2-summary-data-and-python-setup">2. Summary Data and Python Setup</h2> <h3 id="21-summary-statistics-used">2.1 Summary Statistics Used</h3> <p>The analysis uses the following literature-reported values.</p> <table> <thead> <tr> <th>Statistic</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>Min</td> <td>19</td> </tr> <tr> <td>Q1</td> <td>61</td> </tr> <tr> <td>Median</td> <td>66</td> </tr> <tr> <td>Q3</td> <td>72</td> </tr> <tr> <td>Max</td> <td>88</td> </tr> <tr> <td>Mean</td> <td>67</td> </tr> <tr> <td>Sample Size</td> <td>111</td> </tr> </tbody> </table> <p><br>These values provide a robust representation of the distribution’s central tendency and spread.<br><br></p> <h3 id="22-software-environment">2.2 Software Environment</h3> <p>The full workflow uses:</p> <ul> <li> <strong>NumPy</strong> for numerical operations</li> <li> <strong>pandas</strong> for data structuring</li> <li> <strong>SciPy</strong> for probability distributions</li> <li> <strong>statsmodels</strong> for numerical Hessian estimation</li> <li> <strong>matplotlib</strong> for visualization</li> </ul> <p>All version details are recorded to support reproducibility.<br><br></p> <h2 id="3-fitting-parametric-models-from-summary-data">3. Fitting Parametric Models from Summary Data</h2> <h3 id="31-why-use-parametric-distributions">3.1 Why Use Parametric Distributions?</h3> <p>Parametric survival distributions help us:</p> <ul> <li>Interpolate and extrapolate beyond observed quartiles</li> <li>Obtain smooth CDFs and PDFs</li> <li>Compute probabilities within arbitrary age bands</li> <li>Implement Monte Carlo–based uncertainty quantification</li> </ul> <p>This is particularly valuable in rare disease research, where datasets are often small.<br><br></p> <h3 id="32-quantile-matching-reconstructing-the-distribution">3.2 Quantile Matching: Reconstructing the Distribution</h3> <p>Because raw data are missing, we instead match:</p> \[(Q1, Median, Q3)_\text{model} \approx (Q1, Median, Q3)_\text{observed}\] <p>We define an objective function that penalizes deviations between model-predicted and observed quartiles, and we optimize the model’s parameters to minimize this squared error.</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">q1</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">q3</span> <span class="o">=</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">72</span>
<span class="n">empirical_q</span> <span class="o">=</span> <span class="p">[</span><span class="n">q1</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">q3</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">gengamma_objective</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">scale</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">dist</span> <span class="o">=</span> <span class="nf">gengamma</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">)</span>
        <span class="n">theo_q</span> <span class="o">=</span> <span class="n">dist</span><span class="p">.</span><span class="nf">ppf</span><span class="p">([</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">((</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">theo_q</span><span class="p">)</span><span class="o">-</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">empirical_q</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">inf</span>
</code></pre></div></div> <p>This allows us to recover a plausible distribution consistent with the literature.<br><br></p> <h3 id="33-why-generalized-gamma">3.3 Why Generalized Gamma?</h3> <p>While lognormal and Weibull are widely used, the <strong>generalized gamma</strong> provides:</p> <ul> <li>high flexibility in skewness</li> <li>adjustable tail behavior</li> <li>ability to mimic many other survival distributions</li> </ul> <p>After fitting the model via quantile matching, we obtain parameter estimates for shape (a), power (c), and scale (s). These values define the final onset-age distribution.</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">initial_guess_gengamma</span> <span class="o">=</span> <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>
<span class="n">bounds_gengamma</span> <span class="o">=</span> <span class="p">[(</span><span class="mf">0.01</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>

<span class="n">result_gengamma</span> <span class="o">=</span> <span class="nf">minimize</span><span class="p">(</span><span class="n">gengamma_objective</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">initial_guess_gengamma</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds_gengamma</span><span class="p">)</span>

<span class="n">a_fit_gengamma</span><span class="p">,</span> <span class="n">c_fit_gengamma</span><span class="p">,</span> <span class="n">scale_fit_gengamma</span> <span class="o">=</span> <span class="n">result_gengamma</span><span class="p">.</span><span class="n">x</span>
</code></pre></div></div> <table> <thead> <tr> <th>Parameter</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>a</td> <td>26.6110</td> </tr> <tr> <td>c</td> <td>1.5835</td> </tr> <tr> <td>scale</td> <td>8.4092</td> </tr> </tbody> </table> <p><br><br></p> <h3 id="34-diagnostic-checks">3.4 Diagnostic Checks</h3> <p>To validate the fit, we:</p> <ul> <li>simulate onset ages using the fitted parameters</li> <li>plot a histogram compared to the reported median</li> <li>overlay the fitted CDF against empirical quartile points</li> </ul> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/survival_model_diagnostic_check.png" sizes="95vw"></source> <img src="/assets/img/survival_model_diagnostic_check.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>This confirms that the generalized gamma model aligns well with both the median and quartile anchors.<br><br></p> <h2 id="4-adding-uncertainty-probabilistic-sensitivity-analysis-psa">4. Adding Uncertainty: Probabilistic Sensitivity Analysis (PSA)</h2> <h3 id="41-why-psa">4.1 Why PSA?</h3> <p>Health economic and epidemiological models require not only point estimates but also credible intervals, especially when clinical evidence is sparse.</p> <p>Parameter uncertainty in the fitted model must therefore be propagated to all downstream quantities.</p> <p>The overarching goal is to generate randomly sampled, correlated parameter sets that reflect the plausible variance and covariance structure of the original fitted models for PSA.</p> <p>The conceptual procedures are as follows,</p> <ol> <li>Identify the model parameters</li> <li>Build the variance–covariance matrix</li> <li>Calculate the Cholesky factor</li> <li>Generate random noise using MVN</li> <li>Apply the Cholesky factor to preserve correlations</li> <li>Compute the final random parameter draws</li> <li>Use the sampled parameters in the survival model<br> </li> </ol> <h3 id="42-building-the-variance-covariance-matrix">4.2 Building the Variance-Covariance Matrix</h3> <p>We approximate the Hessian numerically at the parameter optimum. Inverting the Hessian yields the variance–covariance matrix of the parameter estimates.</p> <p>This matrix captures both individual parameter uncertainty and correlations among parameters.</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">theta_hat</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">a_fit</span><span class="p">,</span> <span class="n">c_fit</span><span class="p">,</span> <span class="n">scale_fit</span><span class="p">])</span>
<span class="n">H</span> <span class="o">=</span> <span class="nf">approx_hess</span><span class="p">(</span><span class="n">theta_hat</span><span class="p">,</span> <span class="n">gengamma_objective</span><span class="p">)</span>
<span class="n">vcov</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">inv</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</code></pre></div></div> <table> <thead> <tr> <th style="text-align: right"> </th> <th style="text-align: right">a variance/covariance</th> <th style="text-align: right">c variance/covariance</th> <th style="text-align: right">scale variance/covariance</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">a</td> <td style="text-align: right">595.13</td> <td style="text-align: right">-17.76</td> <td style="text-align: right">-315.06</td> </tr> <tr> <td style="text-align: right">c</td> <td style="text-align: right">-17.76</td> <td style="text-align: right">0.55</td> <td style="text-align: right">9.63</td> </tr> <tr> <td style="text-align: right">scale</td> <td style="text-align: right">-315.06</td> <td style="text-align: right">9.63</td> <td style="text-align: right">169.34</td> </tr> </tbody> </table> <p><br> This is a 3×3 variance-covariance matrix for the 3 fitted parameters of the generalized gamma distribution.</p> <p>Diagonal entries = variances of each parameter.</p> <p>Example:</p> \[\mathrm{Var}(a) = 595.13, \quad \mathrm{Var}(c) = 0.551, \quad \mathrm{Var}(\text{scale}) = 169.34\] <p>Off-diagonal entries = covariances between parameters.</p> <p>Example:</p> \[\mathrm{Cov}(a, \text{scale}) = -315.06\] <p><br></p> <h3 id="43-multivariate-normal-sampling">4.3 Multivariate Normal Sampling</h3> <p>Using Cholesky decomposition, we sample thousands of parameter sets from a multivariate normal distribution:</p> \[\theta^{(i)} \sim \text{MVN}(\hat{\theta},\, \Sigma)\] <p>This forms the backbone of the PSA.</p> <div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">default_rng</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">cholesky</span><span class="p">(</span><span class="n">vcov</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">rng</span><span class="p">.</span><span class="nf">standard_normal</span><span class="p">((</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">theta_draws</span> <span class="o">=</span> <span class="n">theta_hat</span> <span class="o">+</span> <span class="n">Z</span> <span class="o">@</span> <span class="n">L</span><span class="p">.</span><span class="n">T</span>
</code></pre></div></div> <p>Even though the fitted parameters \((\mu, \log\sigma, Q)\) are point estimates, each has uncertainty, and they are correlated. For example, if log-sigma increases slightly, Q might decrease slightly to keep the model a good fit.</p> <p>To reflect this, we sample parameters from a multivariate normal distribution centered at the MLE estimates with covariance equal to the Hessian-derived covariance matrix.</p> <p>Here’s what the code does:<br></p> <ol> <li> <p>standard_normal((5000,3)) → generates 5,000 draws of independent noise, one for each parameter.</p> </li> <li> <p>L = cholesky(vcov) → finds a matrix L such that \(LL^\top = \text{covariance}\).<br> This matrix converts independent noise into correlated noise with the correct variability.</p> </li> <li> <p>Z @ L.T → transforms the independent noise into noise that matches the covariance structure of the parameters.</p> </li> <li> <p>theta_hat + … → shifts the draws so they are centered at the fitted parameters.</p> </li> </ol> <p>The resulting theta_draws are 5,000 simulated sets of generalized gamma parameters that realistically reflect estimation uncertainty. These are used to visualize uncertainty in survival curves, median survival, RMST, or other model outputs.<br><br></p> <h2 id="5-estimating-age-band-probabilities">5. Estimating Age-Band Probabilities</h2> <p>For many models, we need to know the probability that onset occurs within:</p> <ul> <li><strong>0–12 years</strong></li> <li><strong>12–18 years</strong></li> <li><strong>18+ years</strong></li> </ul> <p>Using the CDF from each Monte Carlo draw, we compute:</p> \[P(a \leq \text{onset} &lt; b) = F(b) - F(a)\] <p>This avoids slow individual-level simulation and supports rapid PSA.</p> <p>A summary table (across ~5,000 draws) includes:</p> <ul> <li>mean probability</li> <li>standard deviation</li> <li>median</li> <li>95% uncertainty interval (2.5–97.5th percentile)</li> </ul> <table> <thead> <tr> <th>Age Band</th> <th>Mean</th> <th>SD</th> <th>Median</th> <th>CI Lower (2.5%)</th> <th>CI Upper (97.5%)</th> </tr> </thead> <tbody> <tr> <td>0–12</td> <td>2.67%</td> <td>14.00%</td> <td>0.00%</td> <td>0.00%</td> <td>44.47%</td> </tr> <tr> <td>12–18</td> <td>1.95%</td> <td>9.41%</td> <td>0.00%</td> <td>0.00%</td> <td>23.81%</td> </tr> <tr> <td>18+</td> <td>95.38%</td> <td>18.45%</td> <td>100.00%</td> <td>9.54%</td> <td>100.00%</td> </tr> </tbody> </table> <p><br>The results show:</p> <ul> <li>~95% of onsets occur after age 18</li> <li>0–12 and 12–18 have wide uncertainty due to very low event frequency</li> </ul> <p>This output can be plugged directly into disease models.<br><br></p> <h2 id="6-visualizing-uncertainty-cdf-ensembles">6. Visualizing Uncertainty: CDF Ensembles</h2> <p>One of the most insightful plots overlays:</p> <ul> <li> <strong>Light gray curves</strong>: thousands of CDFs generated from sampled parameters</li> <li> <strong>A blue line</strong>: mean CDF across all Monte Carlo draws</li> <li> <strong>Red points</strong>: empirical quartile anchors</li> </ul> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/psa_diag_check.png" sizes="95vw"></source> <img src="/assets/img/psa_diag_check.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>This reveals:</p> <ul> <li>Strong alignment near the median</li> <li>Greatest uncertainty in the tails</li> <li>Minimal probability mass before ~20 years</li> <li>A steep probability rise between 50–70 years</li> </ul> <p>The ensemble plot illustrates not just the best-fit curve, but the <em>range of plausible distributions</em> given uncertainty in the literature.<br><br></p> <h2 id="7-ensuring-reproducibility">7. Ensuring Reproducibility</h2> <p>Reproducibility is essential for transparent modeling, peer review, and regulatory or client submissions.</p> <p>At the end of the analysis, we record:</p> <ul> <li>Python version</li> <li>OS</li> <li>NumPy, pandas, SciPy, statsmodels, matplotlib versions <br><br> </li> </ul> <h2 id="8-conclusion">8. Conclusion</h2> <p>Even when individual-level data are unavailable, we can still reconstruct a meaningful, validated age-at-onset distribution using parametric survival models.</p> <p>The generalized gamma distribution offers excellent flexibility, and the combination of:</p> <ul> <li>Quantile matching</li> <li>Diagnostic validation</li> <li>Probabilistic sensitivity analysis (PSA)</li> </ul> <p>This approach fits naturally into broader health economic and epidemiological frameworks, enabling:</p> <ul> <li>Estimation of onset-age probabilities</li> <li>Sensitivity and uncertainty analyses</li> <li>Population-level burden and cost projections</li> <li>Forecasting models informed by realistic evidence intervals</li> </ul> </div> </article> </div> </div> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Xin (David) Zhao. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script defer src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.22.4/dist/bootstrap-table.min.js" integrity="sha256-4rppopQE9POKfukn2kEvhJ9Um25Cf6+IDVkARD0xh78=" crossorigin="anonymous"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"about",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-blog",title:"blog",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-publications",title:"publications",description:"publications by categories in reversed chronological order. generated by jekyll-scholar.",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"projects",description:"A growing collection of cool projects.",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-cv",title:"cv",description:"",section:"Navigation",handler:()=>{window.location.href="/cv/"}},{id:"dropdown-publications",title:"publications",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-projects",title:"projects",description:"",section:"Dropdown",handler:()=>{window.location.href=""}},{id:"dropdown-blog",title:"blog",description:"",section:"Dropdown",handler:()=>{window.location.href="/blog/"}},{id:"post-parametric-survival-fit-amp-psa-for-age-at-onset-in-autoimmune-disease-generalized-gamma-workflow",title:"Parametric Survival Fit & PSA for Age-at-Onset in Autoimmune Disease: Generalized Gamma Workflow...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/sensitivity-analysis-survival-model/"}},{id:"post-turning-messy-symptom-text-into-structured-insights",title:"Turning Messy Symptom Text into Structured Insights",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/map-hpo-symptom/"}},{id:"post-visualizing-microbiome-taxonomy-with-metacoder-in-r-a-step-by-step-guide",title:"Visualizing Microbiome Taxonomy with Metacoder in R: A Step-by-Step Guide",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/tax-heattree-r/"}},{id:"post-retrieving-full-taxonomy-lineage-from-ncbi-with-python",title:"Retrieving Full Taxonomy Lineage from NCBI with Python",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/retrieve-tax-lineage-API/"}},{id:"post-how-to-reconstruct-disease-onset-age-distributions-using-summary-statistics-a-rare-disease-use-case-in-python",title:"How to Reconstruct Disease Onset Age Distributions Using Summary Statistics: A Rare Disease...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/reconstruct-age-distribution/"}},{id:"post-a-beginner-s-hands-on-guide-to-meta-analysis-and-confidence-intervals",title:"A Beginner\u2019s Hands-On Guide to Meta-Analysis and Confidence Intervals",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/meta-analysis-in-R/"}},{id:"post-evaluating-confidence-interval-methods-under-skewness-practical-insights-from-simulation",title:"Evaluating Confidence Interval Methods under Skewness: Practical Insights from Simulation",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/mean-interval-estimators/"}},{id:"post-comparing-methods-for-estimating-95-confidence-intervals-of-proportions-wald-wilson-and-equal-tailed-jeffreys-prior",title:"Comparing Methods for Estimating 95% Confidence Intervals of Proportions: Wald, Wilson, and Equal-Tailed...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/benchmark-interval-prop/"}},{id:"post-modeling-diagnostic-delays-in-rare-disease-a-survival-analysis-case-study-in-python",title:"Modeling Diagnostic Delays in Rare Disease: A Survival Analysis Case Study in Python...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/delay-diganosis-survival-analysis/"}},{id:"post-from-microbiology-to-bioinformatics-how-embracing-new-skills-transformed-my-career",title:"From Microbiology to Bioinformatics: How Embracing New Skills Transformed My Career",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/my-career-journey/"}},{id:"post-beyond-heatmaps-mapping-two-variables-with-plotly-in-public-health",title:"Beyond Heatmaps: Mapping Two Variables with Plotly in Public Health",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2025/plotly-maps-public-health/"}},{id:"post-how-to-import-excel-files-in-python",title:"How to Import Excel Files in Python",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/import-spreadsheet-python/"}},{id:"post-top-r-packages-for-go-enrichment-analysis-topgo-vs-globaltest-explained",title:"Top R Packages for GO Enrichment Analysis: topGO vs globaltest Explained",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/go-enrichment/"}},{id:"post-how-to-run-r-code-in-jupyter-notebook-within-vs-code-a-step-by-step-guide",title:"How to Run R Code in Jupyter Notebook within VS Code: A Step-by-Step...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/R-kernel-jupyter/"}},{id:"post-how-to-perform-power-analysis-for-high-throughput-omics-data-using-sspa-a-guide-to-the-bioconductor-package",title:"How to Perform Power Analysis for High-Throughput Omics Data Using SSPA, A Guide...",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/power-analysis/"}},{id:"post-automating-reporting-with-rmarkdown",title:"Automating Reporting with RMarkdown",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/auto-reporting-rmarkdown/"}},{id:"post-introduction-to-linear-mixed-models-with-the-limma-package",title:"Introduction to Linear Mixed Models with the limma Package",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/linear-mixed-model/"}},{id:"post-choosing-the-right-dimensionality-reduction-in-metabolomics-navigating-common-pitfalls",title:"Choosing the Right Dimensionality Reduction in Metabolomics: Navigating Common Pitfalls",description:"",section:"Posts",handler:()=>{window.location.href="/blog/2024/choose-dimension-reduction/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"projects-gc-autofit-web-application-automating-and-accelerating-gc-ms-metabolomics",title:"GC-AutoFit: Web Application Automating and Accelerating GC-MS Metabolomics",description:"",section:"Projects",handler:()=>{window.location.href="/projects/gc-autofit/"}},{id:"projects-exploring-ames-housing-prices-a-data-driven-analysis",title:"Exploring Ames Housing Prices: A Data-Driven Analysis",description:"Exploratory data analysis for house price prediction, a Kaggle competition",section:"Projects",handler:()=>{window.location.href="/projects/house-price-prediction/"}},{id:"projects-impact-of-birth-factors-on-infant-gut-health-insights-from-a-microbiota-study",title:"Impact of Birth Factors on Infant Gut Health, Insights from a Microbiota Study...",description:"",section:"Projects",handler:()=>{window.location.href="/projects/infant_bifido_birth/"}},{id:"projects-predict-childhood-obesity-using-rf-xgboost-and-glmm-in-r",title:"Predict Childhood Obesity Using RF, XGBoost and GLMM in R",description:"",section:"Projects",handler:()=>{window.location.href="/projects/predict_obesity_machine_learning/"}},{id:"projects-vitamin-d-and-infant-gut-health-a-regression-analysis",title:"Vitamin D and Infant Gut Health, A Regression Analysis",description:"",section:"Projects",handler:()=>{window.location.href="/projects/vitD_infant_gut/"}},{id:"projects-wegan-web-application-streamlining-ecology-data-analysis",title:"WEGAN: Web Application Streamlining Ecology Data Analysis",description:"",section:"Projects",handler:()=>{window.location.href="/projects/wegan_web_app/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%64%61%76%69%64%7A%68%61%6F%31%30%31%35@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=OVK0_oAAAAAJ&hl=en","_blank")}},{id:"socials-researchgate",title:"ResearchGate",section:"Socials",handler:()=>{window.open("https://www.researchgate.net/profile/Xin-Zhao-5/","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/davidzhao1015","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/davidxzhao","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>